--- a/net/core/sysctl_net_core.c	2019-09-20 22:41:29.994659000 +0800
+++ b/net/core/sysctl_net_core.c	2019-08-09 06:54:24.375881000 +0800
@@ -331,16 +331,14 @@
 		.data		= &sysctl_net_busy_poll,
 		.maxlen		= sizeof(unsigned int),
 		.mode		= 0644,
-		.proc_handler	= proc_dointvec_minmax,
-		.extra1		= &zero,
+		.proc_handler	= proc_dointvec
 	},
 	{
 		.procname	= "busy_read",
 		.data		= &sysctl_net_busy_read,
 		.maxlen		= sizeof(unsigned int),
 		.mode		= 0644,
-		.proc_handler	= proc_dointvec_minmax,
-		.extra1		= &zero,
+		.proc_handler	= proc_dointvec
 	},
 #endif
 #ifdef CONFIG_NET_SCHED
@@ -372,7 +370,6 @@
 		.maxlen		= sizeof(int),
 		.mode		= 0644,
 		.proc_handler	= proc_dointvec_minmax,
-		.extra1		= &one,
 		.extra2		= &max_skb_frags,
 	},
 	{ }
@@ -395,6 +392,8 @@
 {
 	struct ctl_table *tbl;
 
+	net->core.sysctl_somaxconn = SOMAXCONN;
+
 	tbl = netns_core_table;
 	if (!net_eq(net, &init_net)) {
 		tbl = kmemdup(tbl, sizeof(netns_core_table), GFP_KERNEL);
--- a/include/linux/cred.h	2018-05-16 16:05:19.000000000 +0800
+++ b/include/linux/cred.h	2019-09-21 00:09:08.388552977 +0800
@@ -354,10 +354,7 @@
 #ifdef CONFIG_USER_NS
 #define current_user_ns()	(current_cred_xxx(user_ns))
 #else
-static inline struct user_namespace *current_user_ns(void)
-{
-	return &init_user_ns;
-}
+#define current_user_ns()	(&init_user_ns)
 #endif
